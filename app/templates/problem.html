{% extends "base_logined.html" %}
{% block title %}Home{% endblock %}
{% block content %}
<script src="https://s3.amazonaws.com/zappa-static-files-yuanyi/static/js/lib/codemirror.js"></script>
<link rel="stylesheet" href="https://s3.amazonaws.com/zappa-static-files-yuanyi/static/css/lib/codemirror.css">
<script src="https://s3.amazonaws.com/zappa-static-files-yuanyi/static/js/codemirror.js"></script>

<div class="container" id="home" style="display:none">
    <div class="jumbotron">
    {% if description %}
    {{description|safe}}
    {% endif %}
    </div>
    
    <form id="run_form">
        <input id="codename" type="hidden" name="codename" value="{{question_name}}">
        <input id="username" type="hidden" name="username" value="null">

        <div class = "select">
            <select name = "lang" class="form-control">
                <option>language</option>
                <option id="python" name="python">python</option>
                <option id="java" name="java">java</option>
                <option id="ruby" name="ruby">ruby</option>
                <option id="javascript" name="javascript">javascript</option>
            </select>
        </div>
        <br>
        <p>Code</p>
        <div class="CodeMirror cm-s-default" style="border: 1px solid #ddd">
            <textarea name="code" id="code" rows="20" cols="100"></textarea>            
        </div>
        <br>
        <p>Input</p>
        <textarea class="form-control" name="input" id="input" rows="5" cols="100"></textarea>

        <br>
        <div>
            <a href=# id=submit><button class='btn btn-primary'>Run Code</button></a>
        </div>

    </form>
    <br>
    <div>
        <p>Result:</p>
        <textarea readonly class="form-control" name="input" id="result" rows="3" cols="100"></textarea>
    </div>

    <br>
    <br>
    <br>

</div>

<!-- <h1>jQuery Example</h1>
<p><input type=text size=5 name=a> +
   <input type=text size=5 name=b> =
   <span id=result>?</span>
<p><a href=# id=calculate>calculate server side</a>
<h1>END</h1> -->
<script type="text/javascript">
    var textArea = document.getElementById('code');
    var editor = CodeMirror.fromTextArea(textArea,{
        lineWrapping:true,
        lineNumbers: true,
        smartIndent: true,
        indentWithTabs: true,
        mode: "javascript"
    });
    editor.getDoc().setValue('\n\n\n\n\n\n\n\n\n\n\n\n');
    // var myCodeMirror = CodeMirror(document.getElementById("code"), {
        // value: "function myScript(){return 100;}\n",
        // mode:  "python"
    // });
</script>

<script type=text/javascript>
  $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
</script>

<script type=text/javascript>
  $(function() {
    $('a#submit').on('click', function(e) {
    // $('#run_form').on('sbumit', function(e) {
      e.preventDefault();  //prevent form from submitting
      $.getJSON($SCRIPT_ROOT + '/run_code', {
        username: $('input[name="username"]').val(),
        codename: $('input[name="codename"]').val(),
        lang: $('select[name="lang"]').val(),
        code: $('textarea[name="code"]').val(),
        // a: $('input[name="a"]').val(),
        // b: $('input[name="b"]').val()
      }, function(data) {
        $("#result").val(data.result);
      });
      return false;
    });
  });
</script>

{% endblock %}